__author__ = 'chris'
from constraint import *
import util, random

class CSP:

    def __init__(self):
        self.problem = Problem()

    def addVariable(self, newVariable, valueRange):
        self.problem.addVariables(newVariable, valueRange)

    def addConstraint(self, lambdaFn, variables=None):
        self.problem.addConstraint(lambdaFn, variables)

    def solve(self):
        solutions = self.problem.getSolutions()
        return solutions

# constraint to remove variables with overlapping categories
# ignores "Food" and "Restaurants" b/c those tell us nothing
def applyCategoryConstraint(biz1, biz2):
    commonCategories = biz1[1].categories.intersection(biz2[1].categories)
    blockWords = ["Food", "Restaurants"]

    for blockWord in blockWords:
        if blockWord in commonCategories:
            commonCategories.remove(blockWord)
    return len(commonCategories) == 0

# constraint to remove multiple permutations in the CSP, 
# ie. (place1, place2) and (place2, place1) are both valid results but we only want one copy
def applyIDConstraint(biz1, biz2):
    return biz1[1].id < biz2[1].id

def applyTestConstraint(*arg):
    # TODO do stuff like 1 BREAKFAST 1 LUNCH 1 DINNER
    return True

def reduceBizs(filteredBizs, constraints):
    # apply unary constraints
    unaryConstrainedBizs = unaryReduce(filteredBizs, constraints)

    # apply binary constraints via CSP
    binaryConstrainedBizs = binaryReduce(unaryConstrainedBizs, constraints)
    
    return binaryConstrainedBizs

def unaryReduce(filteredBizs, constraints):
    unaryConstrainedBizs = []
    # apply unary constraints against the filtered buisnesses
    for nextBizTuple in filteredBizs:
        nextScore, nextBiz = nextBizTuple

        if "minStars" in constraints:
            if nextBiz.yelpStars < constraints["minStars"]:
                continue
        
        if nextBiz.open == False:
            continue
        
        if "maxPrice" in constraints:
            inPriceRange = True
            for attribute in nextBiz.attributes:
                if attribute == "Price Range":
                    if nextBiz.attributes[attribute] > constraints["maxPrice"]:
                        inPriceRange = False
                    break
            if inPriceRange == False:
                continue

        unaryConstrainedBizs.append(nextBizTuple)

    return unaryConstrainedBizs

def binaryReduce(unaryConstrainedBizs, constraints):
    numVariables = 2
    if "numRecs" in constraints:
        numVariables = constraints["numRecs"]

    csp = CSP()

    for i in range(numVariables):
        csp.addVariable(["rec" + str(i)], unaryConstrainedBizs)

    # add constraint that no 2 categories are the same
    for i in range(numVariables):
        for j in range(i + 1, numVariables):
            csp.addConstraint(applyCategoryConstraint, ("rec" + str(i), "rec" + str(j)))

    for i in range(numVariables - 1):
        csp.addConstraint(applyIDConstraint, ("rec" + str(i), "rec" + str(i + 1)))

    csp.addConstraint(applyTestConstraint)
    return csp.solve()

def evaluateAssignments(numRecs, possibleAssignments):
    highestTotal = -1
    bestAssignment = None

    for assignment in possibleAssignments:
        total = 0
        for i in range(numRecs):
            total += assignment['rec' + str(i)][0]

        if total > highestTotal:
            highestTotal = total
            bestAssignment = assignment

    return bestAssignment

# bizs = []
# jsons = [
# {"business_id": "qCPBS-m_4uDO0EgIYGtoxw", "full_address": "1689 S SanTan Village Pkwy\nGilbert, AZ 85295", "hours": {"Monday": {"close": "00:00", "open": "09:00"}, "Tuesday": {"close": "00:00", "open": "09:00"}, "Friday": {"close": "02:00", "open": "09:00"}, "Wednesday": {"close": "00:00", "open": "09:00"}, "Thursday": {"close": "00:00", "open": "09:00"}, "Sunday": {"close": "00:00", "open": "09:00"}, "Saturday": {"close": "02:00", "open": "09:00"}}, "open": True, "categories": ["Bars", "Golf", "Nightlife", "Active Life", "American (New)", "Restaurants"], "city": "Gilbert", "review_count": 28, "name": "Topgolf", "neighborhoods": [], "longitude": -111.7425148, "state": "AZ", "stars": 4.0, "latitude": 33.319839600000002, "attributes": {"Alcohol": "full_bar", "Noise Level": "loud", "Has TV": True, "Attire": "casual", "Ambience": {"romantic": False, "intimate": False, "classy": False, "hipster": False, "divey": False, "touristy": False, "trendy": False, "upscale": False, "casual": False}, "Good for Kids": True, "Price Range": 3, "Good For Dancing": False, "Delivery": False, "Coat Check": False, "Accepts Credit Cards": True, "Take-out": False, "Happy Hour": False, "Outdoor Seating": True, "Takes Reservations": False, "Waiter Service": True, "Wi-Fi": "free", "Caters": True, "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "breakfast": False, "brunch": False}, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Music": {"dj": False}, "Good For Groups": True}, "type": "business"},
# {"business_id": "Lg5F2e02jBaK0lrqbc8SRw", "full_address": "Karlstr.101\n76137 Karlsruhe", "hours": {"Monday": {"close": "00:00", "open": "17:00"}, "Tuesday": {"close": "14:30", "open": "11:30"}, "Friday": {"close": "00:00", "open": "17:00"}, "Wednesday": {"close": "00:00", "open": "17:00"}, "Thursday": {"close": "14:30", "open": "11:30"}, "Sunday": {"close": "00:00", "open": "17:00"}, "Saturday": {"close": "00:00", "open": "17:00"}}, "open": True, "categories": ["Greek", "Restaurants"], "city": "Karlsruhe", "review_count": 15, "name": "Panorama", "neighborhoods": [], "longitude": 8.3940762000000007, "state": "BW", "stars": 3.0, "latitude": 48.997917700000002, "attributes": {"Outdoor Seating": True, "Takes Reservations": True, "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "breakfast": False, "brunch": False}, "Attire": "casual", "Waiter Service": True, "Price Range": 2}, "type": "business"},
# {"business_id": "9ay2sLv0i1eepyu8GUI62A", "full_address": "1001 New Beginnings Dr\nHenderson, NV 89011", "hours": {"Tuesday": {"close": "20:00", "open": "08:00"}, "Friday": {"close": "22:00", "open": "18:00"}, "Wednesday": {"close": "20:00", "open": "08:00"}, "Thursday": {"close": "20:00", "open": "08:00"}, "Sunday": {"close": "16:00", "open": "08:00"}, "Saturday": {"close": "19:30", "open": "14:30"}}, "open": True, "categories": ["Food", "Coffee & Tea"], "city": "Henderson", "review_count": 5, "name": "Level 242 Cafe & Bookstore", "neighborhoods": [], "longitude": -115.03941500000001, "state": "NV", "stars": 4.5, "latitude": 36.080112, "attributes": {"Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Accepts Credit Cards": True, "Wi-Fi": "free", "Outdoor Seating": False, "Price Range": 1}, "type": "business"},
# {"business_id": "arKckMf7lGNYjXjKo6DXcA", "full_address": "7558 W Thunderbird Rd\nPeoria, AZ 85381", "hours": {"Monday": {"close": "20:00", "open": "11:00"}, "Tuesday": {"close": "20:00", "open": "11:00"}, "Friday": {"close": "21:00", "open": "11:00"}, "Wednesday": {"close": "20:00", "open": "11:00"}, "Thursday": {"close": "20:00", "open": "11:00"}, "Sunday": {"close": "20:00", "open": "16:00"}, "Saturday": {"close": "20:00", "open": "11:00"}}, "open": False, "categories": ["Italian", "Pizza", "Sandwiches", "Restaurants"], "city": "Peoria", "review_count": 12, "name": "Crispy Crust Pizza", "neighborhoods": [], "longitude": -112.22132329999999, "state": "AZ", "stars": 4.0, "latitude": 33.610327499999997, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Caters": True, "Noise Level": "average", "Takes Reservations": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Delivery": False, "Dogs Allowed": False, "Parking": {"garage": False, "street": False, "validated": False, "lot": True, "valet": False}, "Has TV": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good for Kids": True, "Wheelchair Accessible": True}, "type": "business"},
# {"business_id": "UYrzcJMNfczRG4J16j8yzw", "full_address": "11249 W Buckeye Rd\nAvondale, AZ 85323", "hours": {"Monday": {"close": "00:00", "open": "08:00"}, "Tuesday": {"close": "00:00", "open": "08:00"}, "Friday": {"close": "01:00", "open": "08:00"}, "Wednesday": {"close": "00:00", "open": "08:00"}, "Thursday": {"close": "00:00", "open": "08:00"}, "Sunday": {"close": "00:00", "open": "08:00"}, "Saturday": {"close": "03:00", "open": "08:00"}}, "open": True, "categories": ["Mexican", "Restaurants"], "city": "Avondale", "review_count": 19, "name": "La Salsitas", "neighborhoods": [], "longitude": -112.30207979679101, "state": "AZ", "stars": 4.5, "latitude": 33.4353629691253, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "breakfast": True, "brunch": False}, "Caters": True, "Noise Level": "average", "Takes Reservations": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "classy": False, "hipster": False, "divey": False, "touristy": False, "trendy": False, "upscale": False, "casual": True}, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Has TV": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 1}, "type": "business"},
# {"business_id": "VPFCGb_f_NRd-ewW70xlmg", "full_address": "3035 Boulevard Le Carrefour\nLaval, QC H7T 1C8", "hours": {"Monday": {"close": "22:00", "open": "11:00"}, "Tuesday": {"close": "23:00", "open": "11:00"}, "Friday": {"close": "00:00", "open": "11:00"}, "Wednesday": {"close": "23:00", "open": "11:00"}, "Thursday": {"close": "23:00", "open": "11:00"}, "Sunday": {"close": "22:00", "open": "11:00"}, "Saturday": {"close": "00:00", "open": "11:00"}}, "open": True, "categories": ["French", "Restaurants"], "city": "Laval", "review_count": 12, "name": "Table 51", "neighborhoods": [], "longitude": -73.749678000000003, "state": "QC", "stars": 3.5, "latitude": 45.568644599999999, "attributes": {"Take-out": False, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Caters": False, "Noise Level": "average", "Takes Reservations": True, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "classy": False, "hipster": False, "divey": False, "touristy": False, "trendy": False, "upscale": False, "casual": False}, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Has TV": True, "Outdoor Seating": True, "Attire": "dressy", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": False, "Good For Groups": True, "Price Range": 3}, "type": "business"},
# {"business_id": "lUsTQ3hOOcSS1mngqeFKAA", "full_address": "7010 S 27th Ave\nPhoenix, AZ 85041", "hours": {"Sunday": {"close": "12:00", "open": "08:00"}, "Saturday": {"close": "12:00", "open": "08:00"}}, "open": False, "categories": ["Breakfast & Brunch", "Restaurants"], "city": "Phoenix", "review_count": 29, "name": "The Grove Cafe", "neighborhoods": [], "longitude": -112.117267, "state": "AZ", "stars": 4.0, "latitude": 33.382595999999999, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": True}, "Caters": True, "Noise Level": "average", "Takes Reservations": True, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Has TV": False, "Delivery": False, "Dogs Allowed": True, "Parking": {"garage": False, "street": False, "validated": False, "lot": True, "valet": False}, "Wheelchair Accessible": True, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "none", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "sP87lLbNzsRMICzwYUwFQg", "full_address": "5501 Josh Birmingham Pkwy\nCharlotte, NC 28208", "hours": {"Monday": {"close": "20:30", "open": "06:00"}, "Tuesday": {"close": "20:30", "open": "06:00"}, "Friday": {"close": "22:00", "open": "06:00"}, "Wednesday": {"close": "22:00", "open": "06:00"}, "Thursday": {"close": "22:00", "open": "06:00"}, "Sunday": {"close": "22:00", "open": "06:00"}, "Saturday": {"close": "22:00", "open": "06:00"}}, "open": True, "categories": ["Pizza", "Restaurants"], "city": "Charlotte", "review_count": 14, "name": "California Pizza Kitchen", "neighborhoods": [], "longitude": -80.945041000000003, "state": "NC", "stars": 2.0, "latitude": 35.219377999999999, "attributes": {"Take-out": True, "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Caters": False, "Noise Level": "loud", "Takes Reservations": False, "Delivery": False, "Has TV": False, "Outdoor Seating": False, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": False, "Price Range": 2}, "type": "business"},
# {"business_id": "vR3eAwcgkh2EmVJegZO2dQ", "full_address": "3476 W Frye Rd\nChandler, AZ 85226", "hours": {"Monday": {"close": "22:00", "open": "10:30"}, "Tuesday": {"close": "22:00", "open": "10:30"}, "Friday": {"close": "23:00", "open": "10:30"}, "Wednesday": {"close": "22:00", "open": "10:30"}, "Thursday": {"close": "22:00", "open": "10:30"}, "Sunday": {"close": "22:00", "open": "10:30"}, "Saturday": {"close": "23:00", "open": "10:30"}}, "open": True, "categories": ["Food", "Ice Cream & Frozen Yogurt", "American (Traditional)", "Restaurants"], "city": "Chandler", "review_count": 51, "name": "Freddy's Frozen Custard & Steakburgers", "neighborhoods": [], "longitude": -111.90033956985, "state": "AZ", "stars": 3.5, "latitude": 33.298830541626202, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": True, "dinner": False, "breakfast": False, "brunch": False}, "Caters": False, "Noise Level": "average", "Takes Reservations": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Parking": {"garage": False, "street": False, "validated": False, "lot": True, "valet": False}, "Has TV": False, "Outdoor Seating": False, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 1}, "type": "business"},
# {"business_id": "GVYP0ZIYLGt-8Rh5L19XIQ", "full_address": "2100 E Carson St\nSouth Side\nPittsburgh, PA 15203", "hours": {}, "open": False, "categories": ["Burgers", "Restaurants"], "city": "Pittsburgh", "review_count": 7, "name": "Mullen's", "neighborhoods": ["South Side"], "longitude": -79.976068999999995, "state": "PA", "stars": 1.5, "latitude": 40.428286, "attributes": {"Waiter Service": True, "Noise Level": "very_loud", "Caters": False, "Outdoor Seating": False, "Attire": "casual"}, "type": "business"},
# {"business_id": "3wLLf8wRqD1ZQowi9aZSoA", "full_address": "8120 N Hayden Rd\nSte E-100\nScottsdale, AZ 85258", "hours": {"Monday": {"close": "22:00", "open": "11:00"}, "Tuesday": {"close": "22:00", "open": "11:00"}, "Friday": {"close": "22:30", "open": "11:00"}, "Wednesday": {"close": "22:00", "open": "11:00"}, "Thursday": {"close": "22:00", "open": "11:00"}, "Sunday": {"close": "22:00", "open": "11:00"}, "Saturday": {"close": "22:30", "open": "11:00"}}, "open": True, "categories": ["American (New)", "Restaurants"], "city": "Scottsdale", "review_count": 220, "name": "Grassroots Kitchen & Tap", "neighborhoods": [], "longitude": -111.8990372, "state": "AZ", "stars": 4.0, "latitude": 33.555191100000002, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": True, "dinner": True, "brunch": False, "breakfast": False}, "Caters": True, "Noise Level": "average", "Takes Reservations": True, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Parking": {"garage": False, "street": False, "validated": False, "lot": True, "valet": False}, "Has TV": True, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "a0dl_Y26iCSTpw3ZONhphg", "full_address": "2330 S Rainbow Blvd\nWestside\nLas Vegas, NV 89146", "hours": {}, "open": False, "categories": ["Cafes", "Restaurants"], "city": "Las Vegas", "review_count": 24, "name": "The Mad Greek Cafe", "neighborhoods": ["Westside"], "longitude": -115.242347, "state": "NV", "stars": 3.0, "latitude": 36.146244000000003, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Caters": False, "Noise Level": "average", "Takes Reservations": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Has TV": True, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "none", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "Tjlj3DgQxXKKG4AmnbDnIA", "full_address": "9 E Wilson St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "22:00", "open": "11:30"}, "Tuesday": {"close": "22:00", "open": "11:30"}, "Friday": {"close": "22:00", "open": "11:30"}, "Wednesday": {"close": "22:00", "open": "11:30"}, "Thursday": {"close": "22:00", "open": "11:30"}, "Saturday": {"close": "22:00", "open": "11:30"}}, "open": True, "categories": ["Party & Event Planning", "Steakhouses", "Event Planning & Services", "Venues & Event Spaces", "Restaurants"], "city": "Madison", "review_count": 44, "name": "Capitol Chophouse", "neighborhoods": ["Capitol"], "longitude": -89.380776400000002, "state": "WI", "stars": 3.5, "latitude": 43.072776500000003, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": True, "brunch": False, "breakfast": False}, "Caters": False, "Noise Level": "quiet", "Good for Kids": False, "Takes Reservations": True, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "classy": True, "hipster": False, "divey": False, "touristy": False, "trendy": False, "upscale": False, "casual": False}, "Parking": {"garage": True, "street": False, "validated": False, "lot": False, "valet": False}, "Has TV": False, "Outdoor Seating": False, "Attire": "dressy", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good For Kids": False, "Good For Groups": True, "Price Range": 3}, "type": "business"},
# {"business_id": "vUknX2e4fwgShNb2c8sasQ", "full_address": "112 King St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "21:00", "open": "06:30"}, "Tuesday": {"close": "21:00", "open": "06:30"}, "Friday": {"close": "21:00", "open": "06:30"}, "Wednesday": {"close": "22:00", "open": "06:30"}, "Thursday": {"close": "22:00", "open": "06:30"}, "Sunday": {"close": "19:00", "open": "07:00"}, "Saturday": {"close": "21:00", "open": "06:00"}}, "open": True, "categories": ["Food", "Coffee & Tea"], "city": "Madison", "review_count": 38, "name": "Ancora Coffee Roasters", "neighborhoods": ["Capitol"], "longitude": -89.381327900000002, "state": "WI", "stars": 4.5, "latitude": 43.0747201, "attributes": {"Wi-Fi": "free", "Price Range": 1, "Outdoor Seating": True, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Accepts Credit Cards": True, "Wheelchair Accessible": True}, "type": "business"},
# {"business_id": "htkFIMGNHOLqmF0dtFCoiw", "full_address": "1209 Williamson St\nWilliamson - Marquette\nMadison, WI 53703", "hours": {"Monday": {"close": "21:00", "open": "09:00"}, "Tuesday": {"close": "21:00", "open": "09:00"}, "Friday": {"close": "21:00", "open": "09:00"}, "Wednesday": {"close": "21:00", "open": "09:00"}, "Thursday": {"close": "21:00", "open": "09:00"}, "Sunday": {"close": "21:00", "open": "10:00"}, "Saturday": {"close": "21:00", "open": "09:00"}}, "open": True, "categories": ["Food", "Beer, Wine & Spirits"], "city": "Madison", "review_count": 21, "name": "Star Liquor", "neighborhoods": ["Williamson - Marquette", "Willy St"], "longitude": -89.363955799999999, "state": "WI", "stars": 4.5, "latitude": 43.0834975, "attributes": {"Parking": {"garage": False, "street": True, "validated": False, "lot": True, "valet": False}, "Accepts Credit Cards": True, "Wheelchair Accessible": True, "Price Range": 2}, "type": "business"},
# {"business_id": "0wGWhZw81cIG7YjwghZhgw", "full_address": "638 State St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "21:30", "open": "07:00"}, "Tuesday": {"close": "21:30", "open": "07:00"}, "Friday": {"close": "22:00", "open": "07:00"}, "Wednesday": {"close": "21:30", "open": "07:00"}, "Thursday": {"close": "21:30", "open": "07:00"}, "Sunday": {"close": "21:00", "open": "09:00"}, "Saturday": {"close": "22:00", "open": "07:00"}}, "open": True, "categories": ["Food", "Coffee & Tea", "Cafes", "Breakfast & Brunch", "Restaurants"], "city": "Madison", "review_count": 105, "name": "Sunroom Cafe", "neighborhoods": ["Capitol"], "longitude": -89.396178000000006, "state": "WI", "stars": 3.5, "latitude": 43.075158999999999, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": True}, "Caters": False, "Noise Level": "average", "Good for Kids": True, "Takes Reservations": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Has TV": False, "Delivery": False, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Order at Counter": True, "Wheelchair Accessible": False, "Outdoor Seating": False, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good For Kids": True, "Good For Groups": True, "Price Range": 1}, "type": "business"},
# {"business_id": "KglkEgsfJwvi5FlVEeI_Rg", "full_address": "912 E Johnson St\nTenney - Lapham\nMadison, WI 53703", "hours": {}, "open": False, "categories": ["Pizza", "Restaurants"], "city": "Madison", "review_count": 3, "name": "Supreme Pizza", "neighborhoods": ["Tenney - Lapham"], "longitude": -89.376057000000003, "state": "WI", "stars": 2.5, "latitude": 43.0847415, "attributes": {"Take-out": True, "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Delivery": True, "Wheelchair Accessible": False, "Outdoor Seating": False, "Attire": "casual", "Alcohol": "none", "Waiter Service": False, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 1}, "type": "business"},
# {"business_id": "Dn5JUcOKejakeuUwMlSR5Q", "full_address": "119 E Main St\nCapitol\nMadison, WI 53703", "hours": {}, "open": False, "categories": ["Middle Eastern", "Mediterranean", "Moroccan", "Restaurants"], "city": "Madison", "review_count": 17, "name": "Casbah Restaurant", "neighborhoods": ["Capitol"], "longitude": -89.381181100000006, "state": "WI", "stars": 3.0, "latitude": 43.0750283, "attributes": {"Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Takes Reservations": True, "Delivery": False, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Wheelchair Accessible": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": False, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "IgHkvKIzy6Zjx5NBA0i0ng", "full_address": "101 N Hamilton St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "21:00", "open": "17:00"}, "Tuesday": {"close": "22:00", "open": "17:00"}, "Friday": {"close": "14:30", "open": "11:30"}, "Wednesday": {"close": "22:00", "open": "17:00"}, "Thursday": {"close": "22:00", "open": "17:00"}, "Sunday": {"close": "21:00", "open": "17:00"}, "Saturday": {"close": "22:00", "open": "17:00"}}, "open": True, "categories": ["Seafood", "Restaurants"], "city": "Madison", "review_count": 40, "name": "The Blue Marlin", "neighborhoods": ["Capitol"], "longitude": -89.383932999999999, "state": "WI", "stars": 3.5, "latitude": 43.076583100000001, "attributes": {"BYOB": False, "Take-out": False, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": True, "brunch": False, "breakfast": False}, "Caters": False, "Noise Level": "average", "Good for Kids": False, "Takes Reservations": True, "BYOB/Corkage": "no", "Delivery": False, "Ambience": {"romantic": False, "intimate": True, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": False}, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Has TV": False, "Outdoor Seating": True, "Attire": "dressy", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good For Kids": False, "Good For Groups": True, "Price Range": 3}, "type": "business"},
# {"business_id": "Bz4XyeumLTsqS3Ysf3Dcyg", "full_address": "105 State St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "18:00", "open": "09:30"}, "Tuesday": {"close": "18:00", "open": "09:30"}, "Friday": {"close": "18:00", "open": "09:30"}, "Wednesday": {"close": "18:00", "open": "09:30"}, "Thursday": {"close": "18:00", "open": "09:30"}, "Sunday": {"close": "18:00", "open": "12:00"}, "Saturday": {"close": "18:00", "open": "09:30"}}, "open": True, "categories": ["Food", "Specialty Food", "Candy Stores"], "city": "Madison", "review_count": 6, "name": "Clary's Gourmet Popcorn", "neighborhoods": ["Capitol"], "longitude": -89.386905299999995, "state": "WI", "stars": 3.5, "latitude": 43.074641499999998, "attributes": {"Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Accepts Credit Cards": True, "Wheelchair Accessible": False, "Price Range": 1}, "type": "business"},
# {"business_id": "r2DtJRPrDnaMpliSJ9I9_w", "full_address": "827 E Johnson St\nTenney - Lapham\nMadison, WI 53703", "hours": {"Monday": {"close": "21:00", "open": "11:00"}, "Tuesday": {"close": "21:00", "open": "11:00"}, "Friday": {"close": "21:00", "open": "11:00"}, "Wednesday": {"close": "21:00", "open": "11:00"}, "Thursday": {"close": "21:00", "open": "11:00"}, "Sunday": {"close": "21:00", "open": "11:00"}, "Saturday": {"close": "21:00", "open": "11:00"}}, "open": False, "categories": ["Sandwiches", "Restaurants"], "city": "Madison", "review_count": 17, "name": "Mildred's Sandwich Shop", "neighborhoods": ["Tenney - Lapham"], "longitude": -89.376776000000007, "state": "WI", "stars": 3.5, "latitude": 43.083655999999998, "attributes": {"Take-out": True, "Good For": {"dessert": False, "latenight": False, "lunch": True, "dinner": False, "brunch": False, "breakfast": False}, "Noise Level": "quiet", "Takes Reservations": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": False}, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Wheelchair Accessible": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "beer_and_wine", "Waiter Service": False, "Accepts Credit Cards": False, "Good for Kids": True, "Good For Groups": False, "Price Range": 1}, "type": "business"},
# {"business_id": "H-e74SghEFfIz_TdUS_2KQ", "full_address": "453 W Gilman St\nCapitol\nMadison, WI 53703", "hours": {}, "open": False, "categories": ["Falafel", "Mediterranean", "Restaurants"], "city": "Madison", "review_count": 9, "name": "King of Falafel", "neighborhoods": ["Capitol"], "longitude": -89.395030199999994, "state": "WI", "stars": 4.0, "latitude": 43.073604199999998, "attributes": {"Good for Kids": False, "Takes Reservations": True, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Attire": "casual", "Waiter Service": True, "Accepts Credit Cards": True, "Good For Kids": False, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "4dL8yzQu974eCtTI-V4Znw", "full_address": "151 W Gorham St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "22:00", "open": "11:00"}, "Tuesday": {"close": "22:00", "open": "11:00"}, "Friday": {"close": "22:00", "open": "11:00"}, "Wednesday": {"close": "22:00", "open": "11:00"}, "Thursday": {"close": "22:00", "open": "11:00"}, "Sunday": {"close": "22:00", "open": "16:00"}, "Saturday": {"close": "22:00", "open": "12:00"}}, "open": True, "categories": ["Vietnamese", "Thai", "Asian Fusion", "Restaurants"], "city": "Madison", "review_count": 58, "name": "Vientiane Palace Restaurant", "neighborhoods": ["Capitol"], "longitude": -89.390600000000006, "state": "WI", "stars": 3.5, "latitude": 43.075287000000003, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": True, "dinner": True, "brunch": False, "breakfast": False}, "Caters": True, "Noise Level": "quiet", "Good for Kids": True, "Takes Reservations": False, "Has TV": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": True, "classy": False, "trendy": False, "upscale": False, "casual": False}, "Parking": {"garage": False, "street": True, "validated": False, "lot": True, "valet": False}, "Wheelchair Accessible": True, "Outdoor Seating": False, "Attire": "casual", "Alcohol": "beer_and_wine", "Waiter Service": True, "Accepts Credit Cards": True, "Good For Kids": True, "Good For Groups": True, "Price Range": 1}, "type": "business"},
# {"business_id": "rgSSCx0tb9AQyCkAvMSIoQ", "full_address": "543 State St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "22:00", "open": "11:00"}, "Tuesday": {"close": "22:00", "open": "11:00"}, "Friday": {"close": "23:00", "open": "11:00"}, "Wednesday": {"close": "22:00", "open": "11:00"}, "Thursday": {"close": "22:00", "open": "11:00"}, "Sunday": {"close": "21:00", "open": "11:00"}, "Saturday": {"close": "23:00", "open": "11:00"}}, "open": False, "categories": ["Restaurants", "Ethiopian", "Vegan", "African"], "city": "Madison", "review_count": 78, "name": "Buraka Restaurant", "neighborhoods": ["Capitol"], "longitude": -89.395207400000004, "state": "WI", "stars": 3.5, "latitude": 43.074860600000001, "attributes": {"Take-out": True, "Wi-Fi": "free", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": True, "brunch": False, "breakfast": False}, "Noise Level": "quiet", "Takes Reservations": True, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Has TV": False, "Delivery": False, "Dogs Allowed": False, "Parking": {"garage": True, "street": False, "validated": False, "lot": False, "valet": False}, "Wheelchair Accessible": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": True, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "43Jej-sIqlpq9LUXKiYMGA", "full_address": "14 W Mifflin St\nCapitol\nMadison, WI 53703", "hours": {}, "open": False, "categories": ["Bars", "Nightlife", "Lounges"], "city": "Madison", "review_count": 3, "name": "Kimia Lounge", "neighborhoods": ["Capitol"], "longitude": -89.385835099999994, "state": "WI", "stars": 2.0, "latitude": 43.075200299999999, "attributes": {}, "type": "business"},
# {"business_id": "s4Juaxp_7gziJj1DXr2JGg", "full_address": "5 E Wilson St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "23:00", "open": "07:00"}, "Tuesday": {"close": "23:00", "open": "07:00"}, "Friday": {"close": "23:00", "open": "07:00"}, "Wednesday": {"close": "23:00", "open": "07:00"}, "Thursday": {"close": "23:00", "open": "07:00"}, "Saturday": {"close": "23:00", "open": "16:00"}}, "open": True, "categories": ["Bars", "American (New)", "Nightlife", "Restaurants"], "city": "Madison", "review_count": 9, "name": "Madison Club", "neighborhoods": ["Capitol"], "longitude": -89.380750199999994, "state": "WI", "stars": 4.0, "latitude": 43.072649599999998, "attributes": {"Coat Check": True, "Take-out": False, "Wi-Fi": "free", "Good For": {"dessert": False, "latenight": False, "lunch": False, "dinner": False, "brunch": False, "breakfast": False}, "Caters": True, "Noise Level": "quiet", "Takes Reservations": True, "Has TV": True, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": False}, "Happy Hour": True, "Parking": {"garage": False, "street": False, "validated": False, "lot": False, "valet": False}, "Music": {"dj": False, "background_music": True, "jukebox": False, "live": False, "video": False, "karaoke": False}, "Outdoor Seating": True, "Attire": "dressy", "Alcohol": "full_bar", "Waiter Service": True, "Accepts Credit Cards": True, "Good for Kids": False, "Good For Groups": True, "Price Range": 4}, "type": "business"},
# {"business_id": "QFMHjSUt08y0c98SA3aBrA", "full_address": "449 State St\nSte G\nCapitol\nMadison, WI 53703", "hours": {"Tuesday": {"close": "14:30", "open": "11:00"}, "Friday": {"close": "22:00", "open": "16:30"}, "Wednesday": {"close": "14:30", "open": "11:00"}, "Thursday": {"close": "14:30", "open": "11:00"}, "Sunday": {"close": "22:00", "open": "16:30"}, "Saturday": {"close": "14:30", "open": "11:00"}}, "open": True, "categories": ["Sushi Bars", "Japanese", "Restaurants"], "city": "Madison", "review_count": 40, "name": "Wasabi Japanese Restaurant & Sushi Bar", "neighborhoods": ["Capitol"], "longitude": -89.393135000000001, "state": "WI", "stars": 3.5, "latitude": 43.074792000000002, "attributes": {"Take-out": True, "Wi-Fi": "no", "Good For": {"dessert": False, "latenight": False, "lunch": True, "dinner": True, "brunch": False, "breakfast": False}, "Caters": True, "Noise Level": "average", "Good for Kids": True, "Takes Reservations": True, "Has TV": False, "Delivery": False, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": True}, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Wheelchair Accessible": False, "Outdoor Seating": True, "Attire": "casual", "Alcohol": "beer_and_wine", "Waiter Service": True, "Accepts Credit Cards": True, "Good For Kids": True, "Good For Groups": True, "Price Range": 2}, "type": "business"},
# {"business_id": "3WYYCZq4spbRviIFN7dkJw", "full_address": "117 W Main St\nCapitol\nMadison, WI 53703", "hours": {"Monday": {"close": "02:00", "open": "16:00"}, "Tuesday": {"close": "02:00", "open": "16:00"}, "Friday": {"close": "02:30", "open": "11:00"}, "Wednesday": {"close": "02:00", "open": "11:00"}, "Thursday": {"close": "02:00", "open": "11:00"}, "Sunday": {"close": "02:00", "open": "10:00"}, "Saturday": {"close": "02:00", "open": "10:00"}}, "open": False, "categories": ["Pubs", "Bars", "Gay Bars", "Nightlife"], "city": "Madison", "review_count": 16, "name": "Shamrock Bar", "neighborhoods": ["Capitol"], "longitude": -89.384609999999995, "state": "WI", "stars": 4.0, "latitude": 43.072439000000003, "attributes": {"Price Range": 1, "Alcohol": "full_bar", "Good For Dancing": False, "Noise Level": "average", "Coat Check": False, "Has TV": True, "Happy Hour": True, "Music": {"video": True, "live": True, "dj": True, "jukebox": False}, "Outdoor Seating": False, "Parking": {"garage": False, "street": True, "validated": False, "lot": False, "valet": False}, "Ambience": {"romantic": False, "intimate": False, "touristy": False, "hipster": False, "divey": False, "classy": False, "trendy": False, "upscale": False, "casual": False}, "Smoking": "outdoor", "Accepts Credit Cards": True, "Good For Groups": True, "Wheelchair Accessible": True}, "type": "business"}
# ]
#
# for json in jsons:
#     newBiz = util.Biz(json)
#
#     simulateScore = newBiz.yelpStars
#     bizs.append((simulateScore, util.Biz(json)))
#
# numRecs = 4
# constraints = {}
# constraints["numRecs"] = numRecs
# constraints["minStars"] = 4
# constraints["maxPrice"] = 2
#
# assignments = reduceBizs(bizs, constraints)
# '''
# for assignment in assignments:
#     for i in range(numRecs):
#         print assignment['rec' + str(i)].name + " with categories " + str(assignment['rec' + str(i)].categories)
#     print "----------------------------------"
# '''
# print "Found # assignments: " + str(len(assignments))
#
# if len(assignments) > 0:
#     optimal = evaluateAssignments(numRecs, assignments)
#     print "Optimal assignment: "
#     for i in range(numRecs):
#         nextRec = optimal['rec' + str(i)][1]
#         print nextRec.name + " with categories " + str(nextRec.categories) + " with score " + str(nextRec.yelpStars)
